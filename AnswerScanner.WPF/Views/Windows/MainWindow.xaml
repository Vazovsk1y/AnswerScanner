<Window
    x:Class="AnswerScanner.WPF.Views.Windows.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:infr="clr-namespace:AnswerScanner.WPF.Infrastructure"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="clr-namespace:AnswerScanner.WPF.ViewModels"
    Background="{StaticResource MainWindowBackgroundBrush}"
    FontFamily="{StaticResource DefaultFontFamily}"
    Width="1000"
    Height="450"
    MinWidth="1000"
    MinHeight="450"
    d:DataContext="{d:DesignInstance Type=viewmodels:MainWindowViewModel, IsDesignTimeCreatable=True}"
    MouseDown="StartWindowMoving"
    WindowStartupLocation="CenterScreen"
    WindowStyle="None"
    mc:Ignorable="d">

    <WindowChrome.WindowChrome>
        <WindowChrome CornerRadius="0"
                      CaptionHeight="0"
                      GlassFrameThickness="0" />
    </WindowChrome.WindowChrome>

    <Window.Resources>
        <infr:NullVisibilityConverter x:Key="NullVisibilityConverter" />
    </Window.Resources>

    <Grid>
        <DockPanel>
            <Grid DockPanel.Dock="Top"
                  Background="{StaticResource HeaderBackgroundBrush}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <Grid Margin="10, 0, 0, 0">
                    <Image Source="{StaticResource Logo}"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"
                           Width="25"
                           Height="25" />
                </Grid>

                <Menu Background="Transparent"
                      Margin="3, 0, 0, 0"
                      Grid.Column="1">
                    <Menu.Resources>

                        <ControlTemplate x:Key="TopLevelMenuItemTemplate" TargetType="{x:Type MenuItem}">
                            <Border x:Name="MenuItemBorder"
                                    Padding="{TemplateBinding Padding}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    Background="{TemplateBinding Background}">
                                <Grid VerticalAlignment="Center">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <ContentPresenter Content="{TemplateBinding Header}"
                                                      ContentSource="Header"
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                    <Popup Grid.Column="0" AllowsTransparency="True"
                                           IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}"
                                           Placement="Bottom"
                                           PlacementTarget="{Binding ElementName=MenuItemBorder}"
                                           HorizontalOffset="1"
                                           VerticalOffset="-1">
                                        <Border BorderBrush="#414141"
                                                Background="#414141">
                                            <ScrollViewer
                                                Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly={x:Type FrameworkElement}}}">
                                                <ItemsPresenter
                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                            </ScrollViewer>
                                        </Border>
                                    </Popup>
                                </Grid>
                            </Border>
                        </ControlTemplate>

                        <ControlTemplate x:Key="InnerMenuItemTemplate" TargetType="{x:Type MenuItem}">
                            <Border x:Name="templateRoot"
                                    Margin="{TemplateBinding Margin}"
                                    Padding="{TemplateBinding Padding}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    Background="{TemplateBinding Background}"
                                    SnapsToDevicePixels="True">
                                <Grid Margin="-1"
                                      Background="Transparent">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition MinWidth="22"
                                                          SharedSizeGroup="MenuItemIconColumnGroup"
                                                          Width="Auto" />
                                        <ColumnDefinition Width="13" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="30" />
                                        <ColumnDefinition SharedSizeGroup="MenuItemIGTColumnGroup"
                                                          Width="Auto" />
                                        <ColumnDefinition Width="20" />
                                    </Grid.ColumnDefinitions>
                                    <ContentPresenter x:Name="Icon" Content="{TemplateBinding Icon}"
                                                      ContentSource="Icon" HorizontalAlignment="Center"
                                                      Height="16" Margin="10, 3, 3, 3"
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                      VerticalAlignment="Center" Width="16" />
                                    <Border Grid.Column="0" x:Name="GlyphPanel"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="1"
                                            Background="#3D26A0DA" ClipToBounds="False"
                                            HorizontalAlignment="Center" Height="22" Margin="-1,0,0,0"
                                            Visibility="Hidden" VerticalAlignment="Center" Width="22">
                                        <Path x:Name="Glyph"
                                              Data="F1M10,1.2L4.7,9.1 4.5,9.1 0,5.2 1.3,3.5 4.3,6.1 8.3,0 10,1.2z"
                                              Fill="#FF212121" FlowDirection="LeftToRight" Height="11"
                                              Width="10" />
                                    </Border>
                                    <ContentPresenter x:Name="menuHeaderContainer"
                                                      ContentTemplate="{TemplateBinding HeaderTemplate}"
                                                      Content="{TemplateBinding Header}" Grid.Column="2"
                                                      ContentStringFormat="{TemplateBinding HeaderStringFormat}"
                                                      ContentSource="Header" HorizontalAlignment="Left"
                                                      Margin="{TemplateBinding Padding}"
                                                      RecognizesAccessKey="True"
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                      VerticalAlignment="Center" />
                                    <TextBlock x:Name="menuGestureText" Grid.Column="4"
                                               Margin="{TemplateBinding Padding}" Opacity="0.7"
                                               Text="{TemplateBinding InputGestureText}"
                                               VerticalAlignment="Center" />
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="Icon" Value="{x:Null}">
                                    <Setter Property="Visibility" TargetName="Icon" Value="Collapsed" />
                                </Trigger>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter Property="Visibility" TargetName="GlyphPanel" Value="Visible" />
                                    <Setter Property="Visibility" TargetName="Icon" Value="Collapsed" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="TextElement.Foreground" TargetName="templateRoot"
                                            Value="#FF707070" />
                                    <Setter Property="Fill" TargetName="Glyph" Value="#FF707070" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>

                        <Style x:Key="MainMenuItem" TargetType="MenuItem">
                            <Setter Property="Foreground" Value="{StaticResource DefaultForegroundBrush}" />
                            <Setter Property="FontWeight" Value="500" />
                            <Setter Property="FontSize" Value="20" />
                            <Setter Property="Padding" Value="8, 10, 8, 10" />

                            <Setter Property="Template" Value="{StaticResource TopLevelMenuItemTemplate}" />

                            <Style.Triggers>
                                <Trigger Property="IsHighlighted" Value="True">
                                    <Setter Property="Background" Value="{StaticResource DefaultIsMouseOverBrush}" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>

                        <Style x:Key="InnerMenuItem" TargetType="MenuItem">
                            <Setter Property="Foreground" Value="{StaticResource DefaultForegroundBrush}" />
                            <Setter Property="FontWeight" Value="500" />
                            <Setter Property="FontSize" Value="18" />
                            <Setter Property="MinHeight" Value="40" />

                            <Setter Property="Background" Value="{StaticResource HeaderBackgroundBrush}" />
                            <Setter Property="Template" Value="{StaticResource InnerMenuItemTemplate}" />

                            <Style.Triggers>
                                <Trigger Property="IsHighlighted" Value="True">
                                    <Setter Property="Background" Value="{StaticResource DefaultItemSelectedBrush}" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Menu.Resources>

                    <MenuItem Style="{StaticResource MainMenuItem}" Header="Файл">
                        <MenuItem
                            Style="{StaticResource InnerMenuItem}"
                            Command="{Binding UploadQuestionnairesCommand}"
                            Header="Загрузить">
                            <MenuItem.Icon>
                                <Image>
                                    <Image.Source>
                                        <DrawingImage>
                                            <DrawingImage.Drawing>
                                                <DrawingGroup ClipGeometry="M0,0 V512 H512 V0 H0 Z">
                                                    <DrawingGroup.Transform>
                                                        <TranslateTransform X="97.933601379394531"
                                                                            Y="0.03079843707382679" />
                                                    </DrawingGroup.Transform>
                                                    <DrawingGroup Transform="1,0,0,1,225.5625,-0.517578125">
                                                        <GeometryDrawing
                                                            Brush="{StaticResource DefaultForegroundBrush}"
                                                            Geometry="F1 M512,512z M0,0z M0,0C0.73250977,-0.00700928 1.46501953,-0.01401855 2.21972656,-0.02124023 4.62604382,-0.03875584 7.03117209,-0.02722142 9.4375,-0.01367188 11.11849186,-0.01636866 12.79948221,-0.02025264 14.48046875,-0.02526855 17.99754743,-0.03115485 21.5142188,-0.02262896 25.03125,-0.00390625 29.53052189,0.01888312 34.02883927,0.00575532 38.52807617,-0.01819611 41.99746847,-0.03267779 45.46663594,-0.02803731 48.93603516,-0.01768494 50.59456496,-0.01502418 52.25311544,-0.01826444 53.91162109,-0.02760315 56.23329421,-0.03780834 58.55344011,-0.02221466 60.875,0 62.19371094,0.00318237 63.51242187,0.00636475 64.87109375,0.00964355 70.2634298,0.77763063 73.15061472,2.96051062 76.58102036,7.11113167 78.9340868,11.42876309 78.98752291,14.53546036 78.91851807,19.3633728 78.92193577,20.24237956 78.92535347,21.12138631 78.92887473,22.02702963 78.9354521,24.96610768 78.91347983,27.90426811 78.89160156,30.84326172 78.89047305,32.95249408 78.89110701,35.06172802 78.89337158,37.17095947 78.89451952,42.89369985 78.87099696,48.61610506 78.84307575,54.33876753 78.8180756,60.32052379 78.81572118,66.30228769 78.81097412,72.28408813 78.79854031,83.60998879 78.76571306,94.93573505 78.72557616,106.26156771 78.6808712,119.15624023 78.65887459,132.0509201 78.63879442,144.94565082 78.59698091,171.46971219 78.52662082,197.99363651 78.4375,224.51757812 79.30114166,224.50869568 80.16478333,224.49981323 81.05459595,224.49066162 89.2054158,224.41041473 97.35610241,224.34956248 105.50722694,224.31032944 109.69753538,224.28948094 113.88751659,224.26121396 118.07763672,224.21582031 122.12362242,224.17226393 126.16929395,224.14842042 130.21549606,224.13806915 131.75684935,224.13069526 133.29818602,224.11629555 134.83940506,224.0946579 137.00349936,224.06549202 139.16630625,224.06162737 141.33056641,224.06347656 142.56078522,224.05459412 143.79100403,224.04571167 145.0585022,224.03656006 150.52493438,224.81473536 153.52966979,227.3230647 156.8125,231.64257812 159.1103474,236.14172472 159.19789882,240.58699207 158.4375,245.51757812 156.07084786,251.27986161 152.05599392,255.31745766 147.8515625,259.85742188 145.50394777,262.44435656 143.30785802,265.10349002 141.125,267.83007812 137.23429292,272.64423401 133.10749534,277.16682146 128.87963867,281.6809082 125.76225274,285.02822055 122.80190833,288.447446 119.9375,292.01757812 116.11755989,296.7786629 112.04811181,301.23030838 107.87890625,305.68164062 104.76181446,309.02874682 101.80168887,312.44771953 98.9375,316.01757812 95.11755989,320.7786629 91.04811181,325.23030838 86.87890625,329.68164062 83.76181446,333.02874682 80.80168887,336.44771953 77.9375,340.01757812 74.11755989,344.7786629 70.04811181,349.23030838 65.87890625,353.68164062 62.76181446,357.02874682 59.80168887,360.44771953 56.9375,364.01757812 53.46250754,368.33114281 49.85526982,372.48764619 46.125,376.58007812 45.62097656,377.14082031 45.11695313,377.7015625 44.59765625,378.27929688 41.09197692,382.08492738 38.79166809,384.23560256 33.6328125,384.85351562 32.61960937,384.86640625 31.60640625,384.87929688 30.5625,384.89257812 29.55445313,384.9209375 28.54640625,384.94929688 27.5078125,384.97851562 21.13915805,384.0224072 17.26994888,379.56671754 13.125,374.95507812 12.6498999,374.42841553 12.1747998,373.90175293 11.68530273,373.35913086 7.91521601,369.14483643 4.36002131,364.77098118 0.81640625,360.36523438 -2.3597857,356.56319179 -5.73520822,352.9685406 -9.12084961,349.35375977 -13.0224667,345.16428287 -16.63574797,340.79584877 -20.21875,336.33007812 -22.89458171,333.11908007 -25.70608276,330.06728676 -28.5625,327.01757812 -33.00082674,322.27891348 -37.1539225,317.39638487 -41.21875,312.33007812 -43.89458171,309.11908007 -46.70608276,306.06728676 -49.5625,303.01757812 -54.00082674,298.27891348 -58.1539225,293.39638487 -62.21875,288.33007812 -64.89458492,285.11907622 -67.70612569,282.0673318 -70.5625,279.01757812 -75.05536855,274.21938958 -79.28513262,269.2852676 -83.39453125,264.15039062 -86.32160307,260.59571242 -89.45106069,257.24631962 -92.6171875,253.90429688 -96.78486712,248.79093894 -98.13392989,244.45239895 -97.91015625,237.98242188 -97.18257514,232.82395357 -94.95303485,229.63182003 -90.85824585,226.35064697 -87.0377116,224.2256948 -84.80002844,224.03210861 -80.45556641,224.06347656 -79.43012726,224.0626004 -79.43012726,224.0626004 -78.38397217,224.06170654 -76.14347025,224.06447442 -73.90432949,224.09550132 -71.6640625,224.12695312 -70.10322801,224.13442021 -68.54238411,224.14011094 -66.98153687,224.144104 -62.88781522,224.15932372 -58.79466778,224.19857305 -54.70117188,224.24291992 -50.51830817,224.28395229 -46.33535102,224.30213195 -42.15234375,224.32226562 -33.95546665,224.36507165 -25.7590549,224.43327758 -17.5625,224.51757812 -17.56618717,223.42021017 -17.56987434,222.32284222 -17.57367325,221.19222069 -17.66243516,194.50219472 -17.72818577,167.81218787 -17.76974869,141.12204552 -17.79038197,128.21493665 -17.81851735,115.30792523 -17.86425781,102.40087891 -17.90410195,91.15230578 -17.92992724,79.90380323 -17.93885398,68.6551615 -17.94407279,62.6979808 -17.95635511,56.741002 -17.98542023,50.78388596 -18.01255084,45.17789306 -18.02094965,39.57218543 -18.01493073,33.96613312 -18.01603201,31.90778936 -18.02399973,29.84943616 -18.0393219,27.79114914 -18.05921274,24.98153924 -18.05444231,22.17300746 -18.04351807,19.3633728 -18.05516943,18.54818692 -18.0668208,17.73300103 -18.07882524,16.89311254 -18.02359732,11.64095119 -17.01610737,8.69627212 -13.5625,4.51757812 -9.03823413,0.70142191 -5.8581698,0.0141372 0,0z" />
                                                    </DrawingGroup>
                                                    <DrawingGroup Transform="1,0,0,1,16,352">
                                                        <GeometryDrawing
                                                            Brush="{StaticResource DefaultForegroundBrush}"
                                                            Geometry="F1 M512,512z M0,0z M0,0C21.12,0 42.24,0 64,0 64,31.68 64,63.36 64,96 180.16,96 296.32,96 416,96 416,64.32 416,32.64 416,0 437.12,0 458.24,0 480,0 480.16121214,33.74259587 480.16121214,33.74259587 480.1953125,47.90429688 480.2190284,57.67480893 480.24687803,67.4451828 480.30175781,77.21557617 480.341711,84.33195909 480.36745301,91.44822968 480.37635398,98.56472164 480.38155445,102.3305506 480.39371875,106.0960583 480.42292023,109.86178398 480.45022386,113.41178625 480.45841521,116.96133725 480.45243073,120.51143456 480.4540428,122.42417556 480.47548706,124.33686827 480.49768066,126.2494812 480.46363808,133.41067616 479.60382887,138.77097269 476,145 475.62168156,145.65394965 475.24336311,146.3078993 474.85358047,146.98166561 470.64583866,153.8761477 463.61395111,157.84903253 456,160 453.51836188,160.17913945 451.02824268,160.25458313 448.54014874,160.25726891 447.80654461,160.26077498 447.07294048,160.26428105 446.31710592,160.26789337 443.85754299,160.27720134 441.39821715,160.27228565 438.93864441,160.26742554 437.15796459,160.2711621 435.37728642,160.27576364 433.59661084,160.28115618 428.70204379,160.2934008 423.80754501,160.29312399 418.91296613,160.29076743 413.63472079,160.29035964 408.35649745,160.30139482 403.07826233,160.31088257 392.73679102,160.3275014 382.3953425,160.33299251 372.05385896,160.33410732 363.64875477,160.33505735 355.2436581,160.33916536 346.83855629,160.34550858 323.01378006,160.36312315 299.18902185,160.37234707 275.36423906,160.37084763 274.0796139,160.37076772 272.79498874,160.3706878 271.47143555,160.37060547 270.18524377,160.37052371 268.89905199,160.37044195 267.5738847,160.37035771 246.72576738,160.36954467 225.87772228,160.38868615 205.02962586,160.4168822 183.62808244,160.44559862 162.22657425,160.45942319 140.82501107,160.45769465 128.80758223,160.45703033 116.79022911,160.46254088 104.77281761,160.48405075 94.54153925,160.50224614 84.31037093,160.50662334 74.07908341,160.4930319 68.85873778,160.48649409 63.63860338,160.48641454 58.41827774,160.5037384 53.63827426,160.51943795 48.85865005,160.51663731 44.078656,160.49917014 42.35055576,160.49609339 40.62242744,160.49975801 38.89436033,160.51089029 22.38350059,160.61019933 22.38350059,160.61019933 15,156 14.35112436,155.6217336 13.70224872,155.2434672 13.03371018,154.85373819 6.09131076,150.65396556 2.21396446,143.61288476 0,136 -0.24609566,133.13775063 -0.24609566,133.13775063 -0.24050903,130.11538696 -0.24325836,128.96281403 -0.24600769,127.81024109 -0.24884033,126.6227417 -0.24164978,125.37261292 -0.23445923,124.12248413 -0.22705078,122.83447266 -0.22648613,121.49370329 -0.22680428,120.15293331 -0.22793579,118.81216431 -0.22850821,115.18448153 -0.21677194,111.55693175 -0.20278788,107.9292798 -0.19026199,104.13363607 -0.18910855,100.33798909 -0.18673706,96.54232788 -0.18052775,89.36014021 -0.16412437,82.17801363 -0.14403808,74.99585283 -0.11747576,65.28676314 -0.106702,55.57765668 -0.09503365,45.86853981 -0.07624337,30.57898081 -0.03639406,15.2895507 0,0z" />
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingImage.Drawing>
                                        </DrawingImage>
                                    </Image.Source>
                                </Image>
                            </MenuItem.Icon>
                        </MenuItem>

                        <MenuItem Style="{StaticResource InnerMenuItem}"
                                  Command="{Binding ExportQuestionnairesCommand}"
                                  Header="Экспортировать">
                            <MenuItem.Icon>
                                <Image>
                                    <Image.Source>
                                        <DrawingImage>
                                            <DrawingImage.Drawing>
                                                <DrawingGroup ClipGeometry="M0,0 V512 H512 V0 H0 Z">
                                                    <DrawingGroup.Transform>
                                                        <TranslateTransform X="128.30339050292969" Y="0.0859375" />
                                                    </DrawingGroup.Transform>
                                                    <DrawingGroup Transform="1,0,0,1,255.875,-0.375">
                                                        <GeometryDrawing
                                                            Brush="{StaticResource DefaultForegroundBrush}"
                                                            Geometry="F1 M512,512z M0,0z M0,0C1.00804687,-0.02835938 2.01609375,-0.05671875 3.0546875,-0.0859375 9.42334195,0.87017093 13.29255112,5.32586058 17.4375,9.9375 17.9126001,10.4641626 18.3877002,10.9908252 18.87719727,11.53344727 22.64728399,15.74774169 26.20247869,20.12159694 29.74609375,24.52734375 32.9222857,28.32938633 36.29770822,31.92403752 39.68334961,35.53881836 43.5849667,39.72829526 47.19824797,44.09672936 50.78125,48.5625 53.45708171,51.77349805 56.26858276,54.82529137 59.125,57.875 63.56332674,62.61366464 67.7164225,67.49619326 71.78125,72.5625 74.45708171,75.77349805 77.26858276,78.82529137 80.125,81.875 84.56332674,86.61366464 88.7164225,91.49619326 92.78125,96.5625 95.45708492,99.77350191 98.26862569,102.82524633 101.125,105.875 105.61786855,110.67318854 109.84763262,115.60731053 113.95703125,120.7421875 116.88410307,124.29686571 120.01356069,127.64625851 123.1796875,130.98828125 127.34736712,136.10163918 128.69642989,140.44017918 128.47265625,146.91015625 127.74507514,152.06862455 125.51553485,155.2607581 121.42074585,158.54193115 117.6002116,160.66688333 115.36252844,160.86046952 111.01806641,160.82910156 110.33444031,160.82968567 109.65081421,160.83026978 108.94647217,160.83087158 106.70597025,160.82810371 104.46682949,160.79707681 102.2265625,160.765625 100.66572801,160.75815791 99.10488411,160.75246719 97.54403687,160.74847412 93.45031522,160.73325441 89.35716778,160.69400507 85.26367188,160.6496582 81.08080817,160.60862584 76.89785102,160.59044617 72.71484375,160.5703125 64.51796665,160.52750648 56.3215549,160.45930054 48.125,160.375 48.12868717,161.47236795 48.13237434,162.56973591 48.13617325,163.70035744 48.22493516,190.39038341 48.29068577,217.08039026 48.33224869,243.77053261 48.35288197,256.67764148 48.38101735,269.58465289 48.42675781,282.49169922 48.46660195,293.74027234 48.49242724,304.9887749 48.50135398,316.23741663 48.50657279,322.19459732 48.51885511,328.15157612 48.54792023,334.10869217 48.57505084,339.71468506 48.58344965,345.3203927 48.57743073,350.92644501 48.57853201,352.98478876 48.58649973,355.04314196 48.6018219,357.10142899 48.62171274,359.91103889 48.61694231,362.71957066 48.60601807,365.52920532 48.61766943,366.34439121 48.6293208,367.1595771 48.64132524,367.99946558 48.58609732,373.25162694 47.57860737,376.196306 44.125,380.375 39.60073413,384.19115622 36.4206698,384.87844092 30.5625,384.89257812 29.46373535,384.90309204 29.46373535,384.90309204 28.34277344,384.91381836 25.93645618,384.93133397 23.53132791,384.91979954 21.125,384.90625 19.44400814,384.90894679 17.76301779,384.91283077 16.08203125,384.91784668 12.56495257,384.92373298 9.0482812,384.91520709 5.53125,384.89648438 1.03197811,384.87369501 -3.46633927,384.8868228 -7.96557617,384.91077423 -11.43496847,384.92525591 -14.90413594,384.92061544 -18.37353516,384.91026306 -20.03206496,384.90760231 -21.69061544,384.91084257 -23.34912109,384.92018127 -25.67079421,384.93038646 -27.99094011,384.91479279 -30.3125,384.89257812 -31.63121094,384.88939575 -32.94992188,384.88621338 -34.30859375,384.88293457 -39.7009298,384.1149475 -42.58811472,381.9320675 -46.01852036,377.78144646 -48.3715868,373.46381504 -48.42502291,370.35711777 -48.35601807,365.52920532 -48.35943577,364.65019857 -48.36285347,363.77119181 -48.36637473,362.86554849 -48.3729521,359.92647045 -48.35097983,356.98831001 -48.32910156,354.04931641 -48.32797305,351.94008404 -48.32860701,349.8308501 -48.33087158,347.72161865 -48.33201952,341.99887828 -48.30849696,336.27647306 -48.28057575,330.5538106 -48.2555756,324.57205433 -48.25322118,318.59029044 -48.24847412,312.60848999 -48.23604031,301.28258934 -48.20321306,289.95684307 -48.16307616,278.63101041 -48.1183712,265.7363379 -48.09637459,252.84165802 -48.07629442,239.94692731 -48.03448091,213.42286594 -47.96412082,186.89894162 -47.875,160.375 -48.73864166,160.38388245 -49.60228333,160.39276489 -50.49209595,160.4019165 -58.6429158,160.48216339 -66.79360241,160.54301565 -74.94472694,160.58224869 -79.13503538,160.60309718 -83.32501659,160.63136416 -87.51513672,160.67675781 -91.56112242,160.72031419 -95.60679395,160.7441577 -99.65299606,160.75450897 -101.19434935,160.76188286 -102.73568602,160.77628257 -104.27690506,160.79792023 -106.44099936,160.82708611 -108.60380625,160.83095076 -110.76806641,160.82910156 -111.99828522,160.83798401 -113.22850403,160.84686646 -114.4960022,160.85601807 -119.96243438,160.07784276 -122.96716979,157.56951343 -126.25,153.25 -128.5478474,148.75085341 -128.63539882,144.30558606 -127.875,139.375 -125.50834786,133.61271652 -121.49349392,129.57512047 -117.2890625,125.03515625 -114.94144777,122.44822157 -112.74535802,119.7890881 -110.5625,117.0625 -106.67179292,112.24834412 -102.54499534,107.72575666 -98.31713867,103.21166992 -95.19975274,99.86435757 -92.23940833,96.44513212 -89.375,92.875 -85.55505989,88.11391522 -81.48561181,83.66226975 -77.31640625,79.2109375 -74.19931446,75.86383131 -71.23918887,72.44485859 -68.375,68.875 -64.55505989,64.11391522 -60.48561181,59.66226975 -56.31640625,55.2109375 -53.19931446,51.86383131 -50.23918887,48.44485859 -47.375,44.875 -43.55505989,40.11391522 -39.48561181,35.66226975 -35.31640625,31.2109375 -32.19931446,27.86383131 -29.23918887,24.44485859 -26.375,20.875 -22.90000754,16.56143532 -19.29276982,12.40493194 -15.5625,8.3125 -15.05847656,7.75175781 -14.55445313,7.19101563 -14.03515625,6.61328125 -9.47543488,1.66342329 -6.71265109,0.08540269 0,0z" />
                                                    </DrawingGroup>
                                                    <DrawingGroup Transform="1,0,0,1,16,352">
                                                        <GeometryDrawing
                                                            Brush="{StaticResource DefaultForegroundBrush}"
                                                            Geometry="F1 M512,512z M0,0z M0,0C21.12,0 42.24,0 64,0 64,31.68 64,63.36 64,96 180.16,96 296.32,96 416,96 416,64.32 416,32.64 416,0 437.12,0 458.24,0 480,0 480.16121214,33.74259587 480.16121214,33.74259587 480.1953125,47.90429688 480.2190284,57.67480893 480.24687803,67.4451828 480.30175781,77.21557617 480.341711,84.33195909 480.36745301,91.44822968 480.37635398,98.56472164 480.38155445,102.3305506 480.39371875,106.0960583 480.42292023,109.86178398 480.45022386,113.41178625 480.45841521,116.96133725 480.45243073,120.51143456 480.4540428,122.42417556 480.47548706,124.33686827 480.49768066,126.2494812 480.46363808,133.41067616 479.60382887,138.77097269 476,145 475.62168156,145.65394965 475.24336311,146.3078993 474.85358047,146.98166561 470.64583866,153.8761477 463.61395111,157.84903253 456,160 453.51836188,160.17913945 451.02824268,160.25458313 448.54014874,160.25726891 447.80654461,160.26077498 447.07294048,160.26428105 446.31710592,160.26789337 443.85754299,160.27720134 441.39821715,160.27228565 438.93864441,160.26742554 437.15796459,160.2711621 435.37728642,160.27576364 433.59661084,160.28115618 428.70204379,160.2934008 423.80754501,160.29312399 418.91296613,160.29076743 413.63472079,160.29035964 408.35649745,160.30139482 403.07826233,160.31088257 392.73679102,160.3275014 382.3953425,160.33299251 372.05385896,160.33410732 363.64875477,160.33505735 355.2436581,160.33916536 346.83855629,160.34550858 323.01378006,160.36312315 299.18902185,160.37234707 275.36423906,160.37084763 274.0796139,160.37076772 272.79498874,160.3706878 271.47143555,160.37060547 270.18524377,160.37052371 268.89905199,160.37044195 267.5738847,160.37035771 246.72576738,160.36954467 225.87772228,160.38868615 205.02962586,160.4168822 183.62808244,160.44559862 162.22657425,160.45942319 140.82501107,160.45769465 128.80758223,160.45703033 116.79022911,160.46254088 104.77281761,160.48405075 94.54153925,160.50224614 84.31037093,160.50662334 74.07908341,160.4930319 68.85873778,160.48649409 63.63860338,160.48641454 58.41827774,160.5037384 53.63827426,160.51943795 48.85865005,160.51663731 44.078656,160.49917014 42.35055576,160.49609339 40.62242744,160.49975801 38.89436033,160.51089029 22.38350059,160.61019933 22.38350059,160.61019933 15,156 14.35112436,155.6217336 13.70224872,155.2434672 13.03371018,154.85373819 6.09131076,150.65396556 2.21396446,143.61288476 0,136 -0.24609566,133.13775063 -0.24609566,133.13775063 -0.24050903,130.11538696 -0.24325836,128.96281403 -0.24600769,127.81024109 -0.24884033,126.6227417 -0.24164978,125.37261292 -0.23445923,124.12248413 -0.22705078,122.83447266 -0.22648613,121.49370329 -0.22680428,120.15293331 -0.22793579,118.81216431 -0.22850821,115.18448153 -0.21677194,111.55693175 -0.20278788,107.9292798 -0.19026199,104.13363607 -0.18910855,100.33798909 -0.18673706,96.54232788 -0.18052775,89.36014021 -0.16412437,82.17801363 -0.14403808,74.99585283 -0.11747576,65.28676314 -0.106702,55.57765668 -0.09503365,45.86853981 -0.07624337,30.57898081 -0.03639406,15.2895507 0,0z" />
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingImage.Drawing>
                                        </DrawingImage>
                                    </Image.Source>
                                </Image>
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>
                </Menu>

                <StackPanel Grid.Column="2"
                            Orientation="Horizontal"
                            HorizontalAlignment="Right">
                    <Button Style="{StaticResource MinimizeButtonStyle}" />
                    <Button Style="{StaticResource MaximizeButtonStyle}" />
                    <Button Style="{StaticResource CloseWindowButtonStyle}" />
                </StackPanel>

            </Grid>

            <Grid Margin="0,5,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" MinWidth="350" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" MinWidth="400" />
                </Grid.ColumnDefinitions>

                <ListBox
                    Margin="5,0,0,0"
                    Background="Transparent"
                    BorderThickness="0"
                    ItemsSource="{Binding UploadedQuestionnaires}"
                    SelectedItem="{Binding SelectedQuestionnaire}"
                    SelectionMode="Single">
                    <ListBox.Resources>
                        <Style TargetType="{x:Type ListBoxItem}">
                            <Setter Property="Background" Value="Transparent" />
                            <Setter Property="BorderThickness" Value="3" />
                            <Setter Property="Foreground" Value="{StaticResource DefaultForegroundBrush}" />
                            <Setter Property="BorderBrush" Value="{StaticResource DefaultIsMouseOverBrush}" />
                            <Setter Property="Margin" Value="0,0,0,5" />
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="ListBoxItem">
                                        <Border
                                            Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="{TemplateBinding BorderThickness}"
                                            CornerRadius="3">
                                            <Border.Effect>
                                                <DropShadowEffect Color="Black" Direction="270"
                                                                  BlurRadius="5"
                                                                  ShadowDepth="3"
                                                                  Opacity="0.5" />
                                            </Border.Effect>
                                            <ContentPresenter />
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{StaticResource DefaultIsMouseOverBrush}" />
                                </Trigger>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="{StaticResource DefaultIsMouseOverBrush}" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </ListBox.Resources>

                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Margin="15,15,15,10">
                                <StackPanel.Resources>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="FontSize" Value="16" />
                                    </Style>
                                </StackPanel.Resources>
                                <TextBlock
                                    FontWeight="500"
                                    Text="{Binding FilePath}"
                                    TextDecorations="Underline" />
                                <TextBlock Margin="0, 10, 0, 0"
                                           Text="{Binding Questions.Count, StringFormat='Количество вопросов: {0}'}" />
                                <TextBlock Margin="0, 10, 0, 0"
                                           Text="{Binding Type.DisplayName, StringFormat='Тип опросника: {0}'}" />
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>

                <GridSplitter Grid.Column="1"
                              Width="1"
                              Margin="5, 0, 0, 0"
                              ResizeBehavior="PreviousAndNext"
                              HorizontalAlignment="Stretch"
                              VerticalAlignment="Stretch"
                              Background="Black" />

                <TabControl
                    Grid.Column="2"
                    Margin="5,0,0,0"
                    Padding="10"
                    Background="{StaticResource MainWindowBackgroundBrush}"
                    BorderThickness="0"
                    Visibility="{Binding SelectedQuestionnaire, Converter={StaticResource NullVisibilityConverter}}">

                    <TabControl.Resources>
                        <Style TargetType="TabItem">
                            <Setter Property="Foreground" Value="{StaticResource DefaultForegroundBrush}" />
                            <Setter Property="FontWeight" Value="500" />
                            <Setter Property="FontSize" Value="16" />
                            <Setter Property="Background" Value="Transparent" />
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="TabItem">
                                        <Grid>
                                            <Border Padding="20, 10, 20, 10">
                                                <ContentPresenter
                                                    VerticalAlignment="Center"
                                                    HorizontalAlignment="Center"
                                                    ContentSource="Header" />
                                            </Border>

                                            <Border x:Name="Underline"
                                                    Height="5"
                                                    Background="Transparent"
                                                    VerticalAlignment="Bottom" />
                                        </Grid>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter TargetName="Underline"
                                                        Property="Background"
                                                        Value="{StaticResource DefaultItemSelectedBrush}" />
                                                <Setter Property="Foreground"
                                                        Value="{StaticResource DefaultForegroundBrush}" />
                                                <Setter Property="FontWeight" Value="700" />
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </TabControl.Resources>

                    <TabItem Header="Список вопросов">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <TextBox
                                Style="{StaticResource DefaultTextBoxStyle}"
                                Text="{Binding SelectedQuestionnaire.Name, UpdateSourceTrigger=PropertyChanged}"
                                FontSize="16"
                                Margin="0, 5, 0, 0" />
                            <DataGrid Grid.Row="1"
                                      Background="{StaticResource MainWindowBackgroundBrush}"
                                      Margin="0,10,0,0"
                                      FontSize="16"
                                      ColumnWidth="*"
                                      IsReadOnly="True"
                                      Foreground="{StaticResource DefaultForegroundBrush}"
                                      ItemsSource="{Binding SelectedQuestionnaire.Questions}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn
                                        MinWidth="40"
                                        MaxWidth="40"
                                        Binding="{Binding Number}"
                                        ElementStyle="{StaticResource TextCenteredTextBlockStyle}"
                                        Header="№" />
                                    <DataGridTextColumn
                                        MinWidth="300"
                                        ElementStyle="{StaticResource TextWrappedTextBlockStyle}"
                                        Binding="{Binding Text}"
                                        Header="Текст вопроса" />
                                    <DataGridTextColumn
                                        MinWidth="100"
                                        MaxWidth="150"
                                        ElementStyle="{StaticResource TextCenteredTextBlockStyle}"
                                        Binding="{Binding Answer.DisplayName}"
                                        Header="Ответ" />
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>

                    <TabItem Header="Дополнительная информация">
                        <ScrollViewer HorizontalScrollBarVisibility="Auto"
                                      VerticalScrollBarVisibility="Auto">
                            <ItemsControl BorderThickness="0"
                                          ItemsSource="{Binding SelectedQuestionnaire.AdditionalInformation}">

                                <ItemsControl.Resources>

                                    <Style x:Key="ExpanderHeaderStyle" TargetType="ToggleButton">
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                        <Setter Property="VerticalContentAlignment" Value="Center" />
                                        <Setter Property="Background" Value="Transparent" />
                                        <Setter Property="Foreground" Value="{StaticResource DefaultForegroundBrush}" />
                                        <Setter Property="Padding" Value="6" />
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ToggleButton">
                                                    <Border Background="{TemplateBinding Background}"
                                                            Padding="{TemplateBinding Padding}"
                                                            CornerRadius="3">
                                                        <DockPanel>
                                                            <Path x:Name="Arrow"
                                                                  Data="M 0 0 L 6 6 L 12 0"
                                                                  Stroke="{TemplateBinding Foreground}"
                                                                  StrokeThickness="2"
                                                                  VerticalAlignment="Center"
                                                                  HorizontalAlignment="Right"
                                                                  Margin="5,0,0,0"
                                                                  RenderTransformOrigin="0.5, 0.5">
                                                                <Path.RenderTransform>
                                                                    <RotateTransform Angle="0" />
                                                                </Path.RenderTransform>
                                                            </Path>
                                                            <ContentPresenter VerticalAlignment="Center"
                                                                              DockPanel.Dock="Left"
                                                                              Margin="10, 0, 0, 0" />
                                                        </DockPanel>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsChecked" Value="True">
                                                            <Setter TargetName="Arrow" Property="RenderTransform">
                                                                <Setter.Value>
                                                                    <RotateTransform Angle="180" />
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>

                                    <Style TargetType="Expander">
                                        <Setter Property="Padding" Value="10" />
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Expander">
                                                    <DockPanel>
                                                        <ToggleButton
                                                            IsChecked="{Binding IsExpanded, RelativeSource={RelativeSource TemplatedParent}}"
                                                            Content="{TemplateBinding Header}"
                                                            Style="{StaticResource ExpanderHeaderStyle}"
                                                            DockPanel.Dock="Top" />
                                                        <ContentPresenter x:Name="ExpandSite"
                                                                          Visibility="Collapsed"
                                                                          Focusable="false"
                                                                          Margin="{TemplateBinding Padding}" />
                                                    </DockPanel>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsExpanded" Value="True">
                                                            <Setter TargetName="ExpandSite" Property="Visibility"
                                                                    Value="Visible" />
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>

                                </ItemsControl.Resources>

                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Expander Header="{Binding Key}"
                                                  Foreground="{StaticResource DefaultForegroundBrush}"
                                                  FontSize="16">
                                            <TextBlock
                                                Text="{Binding Value}"
                                                FontWeight="450"
                                                TextAlignment="Justify"
                                                TextWrapping="Wrap" />
                                        </Expander>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </TabItem>
                </TabControl>

            </Grid>
        </DockPanel>
    </Grid>

</Window>